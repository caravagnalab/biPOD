<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="biPOD">
<title>5. biPOD Supplementary Materials and Methods • biPOD</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="5. biPOD Supplementary Materials and Methods">
<meta property="og:description" content="biPOD">
<meta property="og:image" content="https://caravagnalab.github.io/biPOD/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">biPOD</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/biPOD.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/a1_introduction.html">1. Introduction</a>
    <a class="dropdown-item" href="../articles/a2_task1.html">2. Task 1</a>
    <a class="dropdown-item" href="../articles/a3_task2.html">3. Task 2</a>
    <a class="dropdown-item" href="../articles/a4_task3.html">4. Task 3</a>
    <a class="dropdown-item" href="../articles/a5_supplementary_materials.html">5. biPOD Supplementary Materials and Methods</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>5. biPOD Supplementary Materials and Methods</h1>
            
      
      
      <div class="d-none name"><code>a5_supplementary_materials.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h2>
<div class="section level3">
<h3 id="multi-step-logistic-and-exponential-growth-models">Multi-step logistic and exponential growth models<a class="anchor" aria-label="anchor" href="#multi-step-logistic-and-exponential-growth-models"></a>
</h3>
<p>A general growth process can be seen as a continuous-time Markov
process [8,11], where <span class="math inline">\(y(x) \in
\mathbb{N}_0\)</span> represents the number of individuals in the
population of cancerous cell at time <span class="math inline">\(t\)</span>, and <span class="math inline">\(t_0\)</span> indicates the instant of time in
which the first cancerous cell is born, i.e. <span class="math inline">\(y(x=t_0)=1\)</span>. The transition rates for such
problem are defined as:</p>
<p><span class="math display">\[\begin{align*}
    \alpha_n(x) = \lim_{h \rightarrow 0^+} \frac{1}{h} P[y(x+h) = n+1
\mid y(x)=n]\\
    \beta_n(x) = \lim_{h \rightarrow 0^+} \frac{1}{h} P[y(x+h) = n-1
\mid y(x)=n]
\end{align*}\]</span></p>
<p>Where <span class="math inline">\(\alpha_n(t)\)</span> and <span class="math inline">\(\beta_n(t)\)</span> are both positive functions
and indicates the birth and death rates of the population when <span class="math inline">\(y(x)=n\)</span>. Similarly, one can denote with
<span class="math inline">\(\alpha(t)\)</span> and with <span class="math inline">\(\beta(t)\)</span> the individual birth and death
rate at time <span class="math inline">\(t\)</span>. Assuming that <span class="math inline">\(y(0)=n_0\)</span> with <span class="math inline">\(n_0 \in \mathbb{N}\)</span> and given <span class="math inline">\(m \in \mathbb{N}_0\)</span>, one is interested in
computing</p>
<p><span class="math display">\[\begin{align*}
    P_{n_0,m}(x) = P[y(x)=m \mid y(0)=n_0], \quad t \geq 0
\end{align*}\]</span></p>
<p>which represents the probability that the population reaches a
population size equal to <span class="math inline">\(m\)</span> at time
<span class="math inline">\(x\)</span> conditioned on the population
size at <span class="math inline">\(x=0\)</span>. Quite trivially, <span class="math inline">\(P_0m=0 \hspace{1mm} \forall m&gt;0\)</span>,
meaning that 0 is an absorbing state for the Markov process. The
probability generating function for this process is</p>
<p><span class="math display">\[\begin{align*}
    G(z,x) = \sum_{m=0}^{\infty} P_{n_0m}(x)z^m
\end{align*}\]</span></p>
<p>and, as shown in [12], can be rewritten as</p>
<p><span class="math display">\[\begin{align*}
    G(z,x) = [1-(z-1)[(z-1)\phi(x)-\psi(x)]^{-1}]^{n_0}
\end{align*}\]</span></p>
<p>where the quantities <span class="math inline">\(\phi(x)\)</span> and
<span class="math inline">\(\psi(x)\)</span> depends on the functional
form of the individuals birth and death rates:</p>
<p><span class="math display">\[\begin{align*}
    \psi(x) = \exp \left\{ -\int_0^x (\alpha(\tau) - \beta(\tau)) d\tau
\right\} \\
    \phi(x) = \int_0^x \alpha(\tau) \psi(\tau) d\tau
\end{align*}\]</span></p>
<p>Hence, it is possible to easily compute the expectation and the
variance of <span class="math inline">\(y(x)\)</span>:</p>
<p><span class="math display">\[\begin{align*}
    \mathbb{E}_{n_0}(x) = \mathbb{E}[y(x) \mid n_0] =
\frac{n_0}{\psi(x)} \\
    \text{Var}_{n_0}(x) = n_0 \frac{\psi(x) + 2\phi(x)-1}{\psi^2(x)}
\end{align*}\]</span></p>
</div>
<div class="section level3">
<h3 id="exponential-growth">Exponential growth<a class="anchor" aria-label="anchor" href="#exponential-growth"></a>
</h3>
<p>The first growth pattern we consider can be expressed through a
simple yet ubiquitous differential equation:</p>
<p><span class="math display">\[\begin{align*}
    \frac{dy(x)}{dx} = \rho y(x)
\end{align*}\]</span></p>
<p>where <span class="math inline">\(\rho \geq 0\)</span> represents the
growth rate. The solution of the aforementioned equation yields</p>
<p><span class="math display">\[\begin{align*}
    y(x) = n_0e^{\rho x}
\end{align*}\]</span></p>
<p>indicating that a population starting from <span class="math inline">\(n_0\)</span> will evolve exponentially over time
with no upper bounds. In such growth pattern, the transition rates can
be written as</p>
<p><span class="math display">\[\begin{align*}
    \alpha_n=y\alpha(x) \quad \beta_n=y\beta(x)
\end{align*}\]</span></p>
<p>It’s natural to observe that the birth and death rates are linear
with respect to <span class="math inline">\(n\)</span>, meaning that the
probability of a birth (or death) happening in an infinitesimal
time-interval is proportional to the previous size of the population.
Let <span class="math inline">\(\rho(x) = \alpha(x) - \beta(x)\)</span>
be the individual net growth rate at time <span class="math inline">\(x\)</span> and assume that <span class="math inline">\(\rho(x)\)</span> is a piece-wise constant
function, representing different net growth rates for a multi-step
growth process. Without loss of generality, consider a process with a
single known time-point <span class="math inline">\(t_1\)</span> in
which the net growth rate changes from <span class="math inline">\(\rho_0\)</span> to <span class="math inline">\(\rho_1\)</span>; in such case the form of <span class="math inline">\(\psi(x)\)</span> will be</p>
<p><span class="math display">\[\begin{align*}
    \phi(x) = \exp \left\{ -\rho_0 x\right\}, \quad x \leq t_1 \\
    \phi(x) = \exp \left\{ -\rho_0 t_1\right\} \exp \left\{ -\rho_1
(x-t_1)\right\}, \quad x &gt; t_1
\end{align*}\]</span></p>
<p>It’s trivial to see that this can be generalised to any number of
time-points, i.e. to any number of different growth rates, and that the
expected mean conditioned on <span class="math inline">\(n_0\)</span>
can be computed as</p>
<p><span class="math display">\[\begin{align*}
    \mathbb{E}_{n_0}(x) = n_0 \exp \left\{ \rho_0 x\right\}, \quad x
\leq t_1 \\
    \mathbb{E}_{n_0}(x) = n_0 \exp \left\{ \rho_0 t_1\right\} \exp
\left\{ \rho_1 (x-t_1)\right\}, \quad x \leq t_1
\end{align*}\]</span></p>
</div>
<div class="section level3">
<h3 id="logistic-growth">Logistic growth<a class="anchor" aria-label="anchor" href="#logistic-growth"></a>
</h3>
<p>The logistic model is a generalisation of the exponential one which
takes into account the possibility that the maximum population size is
constrained. In this case we define the carrying capacity <span class="math inline">\(L\)</span> as such upper bound, which can be
caused by many environmental factors such as the availability of
resources or space. The generalised differential equation becomes</p>
<p><span class="math display">\[\begin{align*}
    \frac{dy(x)}{dx} = \rho \left[ 1 - \frac{y(x)}{L} y(x) \right]
\end{align*}\]</span></p>
<p>The second term modulates the effective growth rate affecting the
population: a bigger population size leads to a slower growth. By
letting <span class="math inline">\(L \rightarrow \infty\)</span>, the
logistic equation tends to the exponential one. The equation can easily
be solved by separation of variables and which yields as solution</p>
<p><span class="math display">\[\begin{align*}
    y(x) = \frac{n_0L}{n_0 + (L - n_0) \exp\{-\rho x\}}
\end{align*}\]</span></p>
<p>One can also merge the two terms of the differential equation and
substitute them with a time-dependent growth rate: <span class="math display">\[\begin{align*}
    \frac{dy(x)}{dx} = \nu(x) y(x)
\end{align*}\]</span></p>
<p>In this case, the solution for <span class="math inline">\(\nu
(t)\)</span> is straightforward:</p>
<p><span class="math display">\[\begin{align*}
    \nu(x) = \frac{\rho (L - n_0)}{(L-n_0) + n_0 \exp \{ \rho x \}}
\end{align*}\]</span></p>
<p>Now, similarly as what has been done in the exponential case where
indicated the net growth rate per capita and was defined as a piece-wise
constant function, <span class="math inline">\(\nu (x)\)</span> once
again represents the net growth rate per capita which depends on the
initial conditions, the carrying capacity <span class="math inline">\(L\)</span> and the functional form of <span class="math inline">\(\rho\)</span>. Once again, we assume <span class="math inline">\(\rho\)</span> to be piece-wise constant and we
denote as ti its changing points. Hence, we are modelling growth
patterns in which the net growth rate changes over the time not only
depending on the population size, but also on the value of the
piece-wise constant function <span class="math inline">\(\rho(t)\)</span>. Now, without loss of generality
let’s consider a single changing point <span class="math inline">\(t_1\)</span> so that one can first compute <span class="math inline">\(\psi(x)\)</span> and the the expected mean
conditioned on the starting conditions (i.e. the value of <span class="math inline">\(n_0\)</span>)</p>
<p><span class="math display">\[\begin{align*}
    \mathbb{E}_{n_0}(x) = \frac{n_0L}{n_0 + (L - n_0) \exp\{-\rho_0
x\}}, \quad x \leq t_1 \\
    \mathbb{E}_{n_0}(x) = \frac{n_1L}{n_1 + (L - n_1) \exp\{-\rho_1
(x-t_1)\}}, \quad x &gt; t_1
\end{align*}\]</span></p>
<p>where we define <span class="math inline">\(n_1\)</span> as <span class="math inline">\(\mathbb{E}_{n_0}(x=t_1)\)</span>.</p>
</div>
<div class="section level3">
<h3 id="start-of-the-process">Start of the process<a class="anchor" aria-label="anchor" href="#start-of-the-process"></a>
</h3>
<p>We discussed so far the situation in which <span class="math inline">\(y(0)=n_0\)</span> since the most common situation
is that the first observation of a growth process happens much later
than the actual start of the process. Nonetheless, one could also be
interested in obtaining an estimate, or at least an upper bound, for
<span class="math inline">\(t_0 = \min\{x \mid y(x)=1\}\)</span>. This
can be done by simply shifting by <span class="math inline">\(t_0\)</span> the values of all the instant of
times (i.e. with the change of variables <span class="math inline">\(x'=x-t_0\)</span>). The only modification to
the model is that now <span class="math inline">\(y(x'=0)=1\)</span>.</p>
</div>
<div class="section level3">
<h3 id="population-dynamics-change-points-detection">Population dynamics change-points detection<a class="anchor" aria-label="anchor" href="#population-dynamics-change-points-detection"></a>
</h3>
<p>In general, the change-points <span class="math inline">\(t_i\)</span> defining the intervals of time of the
piece-wise functions that we consider might not be known and, therefore,
a method to infer them is needed. The main assumption we make is that
the underlying growth rates do change sign at the breakpoints. In other
words, at a given change point, the population should change its status
from “growing” to “shrinking” or viceversa. It follows that the
change-points will be found at the locations in which the true function
<span class="math inline">\(y(x)\)</span> describing the process will
present either a minimum or a maximum, or, equivalently, in which the
first derivative <span class="math inline">\(y'(x)\)</span> will be
zero. Given the intrinsic noise present in the observations, a point
might look like a maximum/minimum of the function without actually being
one. Because of this, we make use of a spline approximation to smooth
out the noise and to propose a set of candidates change-points <span class="math inline">\(\hat{t_i}\)</span> which will be used as priors
during the inference of the breakpoints.</p>
<p>The cubic spline estimate <span class="math inline">\(\hat{y}\)</span> is the function that minimize
[13]</p>
<p><span class="math display">\[\begin{align*}
    \frac{1}{n}\sum_{j=1}^n \left[ \hat{y}(x_n) - y_n)\right]^2 +
\lambda \int \hat{y}''(x)^2 dx
\end{align*}\]</span></p>
<p>where <span class="math inline">\(\lambda\)</span> is a smoothing
parameter that controls the trade-off between the “fitness” (first term)
and the “roughness” (second term) of the approximation. It’s easy to
notice that <span class="math inline">\(\lambda = 0\)</span> produces
the interpolating splines whereas <span class="math inline">\(\lambda
\rightarrow \infty\)</span> produces a linear least squares estimate.
Once the approximation <span class="math inline">\(\hat{y}\)</span> is
obtained, one can easily compute the points in which its first
derivative changes sign. We denote those points as <span class="math inline">\(\hat{t_i}\)</span>. Obviously, the choice of <span class="math inline">\(\lambda\)</span> affects the multiplicity of the
minima/maxima that will be found. Therefore, <span class="math inline">\(\lambda\)</span> can either be user-defined or can
be tuned in order to obtain a user-defined number of change-points. Once
the set of <span class="math inline">\(\hat{t_i}\)</span> have been
found, we define a prior over them. For each <span class="math inline">\(i\)</span> we choose a truncated normal
distribution with the following characteristics:</p>
<p>Moreover, the prior distributions are constrained by the fact that
the inferred change-points should be in increasing order and therefore
we enforce that their intervals do not overlap. Hence, considering <span class="math inline">\(\Delta t_i=t_i-t_{i-1}\)</span>, <span class="math inline">\(\sigma_t\)</span> might change according to</p>
<p><span class="math display">\[\begin{align*}
    \sigma_t = \min \{ \sigma_t, \min \{ \frac{1}{2}\Delta t_i \} \}
\end{align*}\]</span></p>
<p>Then, the inference is carried out in order to obtain posterior
distributions for the change points and the medians of such posteriors
can be used as “true” change points for the first task.</p>
</div>
<div class="section level3">
<h3 id="nested-growth-models-for-competing-populations">Nested growth models for competing populations<a class="anchor" aria-label="anchor" href="#nested-growth-models-for-competing-populations"></a>
</h3>
<p>A typical scenario is the one in which a tumor is treated, its mass
shrinks and it later regrows. In this case, the observed dynamics is
U-shaped. For such cases, we assume the presence of two populations
<span class="math inline">\(s\)</span> and <span class="math inline">\(r\)</span>; the first is sensitive to the
treatment, whereas the second one is resistant to it. This means that a
positive and a negative growth rates will be exhibited by the two
populations, respectively.</p>
<p>The sensitive population is assumed to be present at the start of
treatment with the initial condition <span class="math inline">\(y_s(x=0)=n_s\)</span> and is governed by the
differential equation</p>
<p><span class="math display">\[\begin{align*}
    \frac{dy_s(x)}{dx} = -\rho_s (x)
\end{align*}\]</span></p>
<p>For the second population is assumed that the first resistant cell is
born at <span class="math inline">\(x=t_r\)</span>. Therefore, the
differential equation governing the dynamics of the resistant population
will be</p>
<p><span class="math display">\[\begin{align*}
  \frac{dy_r(x)}{dx} = u(x - t_r) \rho_r y_r
\end{align*}\]</span></p>
<p>where the Heaviside function <span class="math inline">\(u(x-t_r)\)</span> is defined as</p>
<p><span class="math display">\[\begin{equation}
  u(x-t_r) =
   \left\{\begin{array}{lr}
       0, &amp;  x \le t_r \\
       1, &amp;  x &gt; t_r
    \end{array}\right.
\end{equation}\]</span></p>
<p>Trivially, the observed counts <span class="math inline">\(y(x)\)</span> will be the sum of the two
populations and can be obtained analytically by integrating the two
equations above and summing them. For <span class="math inline">\(x \ge
0\)</span> this gives:</p>
<p><span class="math display">\[\begin{align*}
    y(x) = n_s \exp\{-\rho_s x\} + u(x - t_r) \exp\{\rho_r (x - t_r)\}
\end{align*}\]</span></p>
</div>
<div class="section level3">
<h3 id="likelihood-compuation">Likelihood compuation<a class="anchor" aria-label="anchor" href="#likelihood-compuation"></a>
</h3>
<p>For all the presented models and for a given set of observations
<span class="math inline">\(X =\{(x_n, y_n\)}\)</span> we consider each
of them as drawn from a poisson process with parameter equal to the
expected value of the population <span class="math inline">\(\mathbb{E}_y(x)\)</span> where the analytical form
of the expected value will depend on the considered task. This means
that for a given task with parameters <span class="math inline">\(\theta\)</span>, the likelihood will be computed
as:</p>
<p><span class="math display">\[\begin{align*}
\mathbb{L}(X \mid \theta) = \prod_{n=1}^{|X|} \text{Poisson}(y_n \mid
\mathbb{E}[ y(x_n) \mid \theta])
\end{align*}\]</span></p>
</div>
</div>
<div class="section level2">
<h2 id="models-pgms">Models’ PGMs<a class="anchor" aria-label="anchor" href="#models-pgms"></a>
</h2>
<p>The probabilistic graphical models for the tree different task will
be presented and the prior distributions employed in each of them will
be described in detail.</p>
<div class="section level3">
<h3 id="task-1">Task 1<a class="anchor" aria-label="anchor" href="#task-1"></a>
</h3>
<center>
<img src="../reference/figures/pgm_1.png" width="200">
</center>
<p>Given the trajectory <span class="math inline">\(X =\{(x_n,
y_n\)}\)</span> of a population divided in <span class="math inline">\(J\)</span> time windows, the parameters of
interest will be the <span class="math inline">\(J\)</span> growth rates
<span class="math inline">\(\rho_j\)</span>, the instant of time <span class="math inline">\(t_0\)</span> in which the population was born and,
if the population is undergoing a logistic growth, the carrying capacity
<span class="math inline">\(L\)</span>.</p>
<p>The priors for those values are:</p>
<span class="math display">\[\begin{gathered}
    \rho_j \sim \text{Normal}(0,1) \\
    t_0 \sim \text{TruncatedNormal}(x_1, 100, -\infty, x_1) \\
    L \sim \text{TruncatedNormal}(\text{max}(x_n), \text{max}(x_n),
\text{max}(x_n), \infty)
\end{gathered}\]</span>
<p>We choose a standard normal for the growth rates, a broad normal for
<span class="math inline">\(t_0\)</span> with the constraint that <span class="math inline">\(t_0\)</span> must be smaller or equal to the time
of the first observation, and a broad normal for the carrying capacity
with the constraint that <span class="math inline">\(L\)</span> must be
greater or equal to the largest observation.</p>
</div>
<div class="section level3">
<h3 id="task-2">Task 2<a class="anchor" aria-label="anchor" href="#task-2"></a>
</h3>
<center>
<img src="../reference/figures/pgm_2.png" width="200">
</center>
<p>Given the trajectory <span class="math inline">\(X =\{(x_n,
y_n\)}\)</span> of a population, the parameters of interest will be the
<span class="math inline">\(J-1\)</span> change points, where <span class="math inline">\(J-1\)</span> is either given by the user or is the
results of the choice of the <span class="math inline">\(\lambda\)</span> parameter in the spline
approximation.</p>
<p>The priors for those values are:</p>
<span class="math display">\[\begin{gathered}
    t_j \sim \text{TruncatedNormal}(\hat{t_j},\sigma_t, \hat{t_j} -
\sigma_t, \hat{t_j} + \sigma_t) \\
\end{gathered}\]</span>
<p>Essentially, for each <span class="math inline">\(\hat{t_j}\)</span>
proposed by the spline approximation we choose a flat normal
distribution constrained in the interval <span class="math inline">\([\hat{t_j}-\sigma_t, \hat{t_j} +
\sigma_t]\)</span>.</p>
</div>
<div class="section level3">
<h3 id="task-3">Task 3<a class="anchor" aria-label="anchor" href="#task-3"></a>
</h3>
<center>
<img src="../reference/figures/pgm_3.png" width="200">
</center>
<p>Given the trajectory <span class="math inline">\(X =\{(x_n,
y_n\)}\)</span> where a resistant and a sensitive population are assumed
to co-exist, the parameters of interest will the two growth rates <span class="math inline">\(\rho_s\)</span> and <span class="math inline">\(\rho_r\)</span>, the size of the sensitive
population <span class="math inline">\(n_s\)</span> at the instant of
time of the first observation and the instant of time in which the
resistant population is born <span class="math inline">\(t_r\)</span>.</p>
<p>The priors for those values are:</p>
<span class="math display">\[\begin{gathered}
    \rho_s \sim \text{HalfNormal}(0,1) \\
    \rho_r \sim \text{HalfNormal}(0,1) \\
    n_s \sim \text{TruncatedNormal}(\frac{y_1}{2}, y_1, 1, 1.1 y_1) \\
    t_r \sim \text{Normal}(x_1, 100)
\end{gathered}\]</span>
<p>Essentially, we choose a standard normal distribution for the two
growth rates, a very broad normal for <span class="math inline">\(n_s\)</span> with the constraint that if at the
beginning the resistant population is not born yet, the maximum error we
are committing is 10%, and a very flat normal distribution centered on
the beginning of the process for <span class="math inline">\(t_r\)</span>.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Giovanni Santacatterina.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
