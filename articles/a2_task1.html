<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="biPOD">
<title>2. Task 1 • biPOD</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="2. Task 1">
<meta property="og:description" content="biPOD">
<meta property="og:image" content="https://caravagnalab.github.io/biPOD/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">biPOD</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/biPOD.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/a1_introduction.html">1. Introduction</a>
    <a class="dropdown-item" href="../articles/a2_task1.html">2. Task 1</a>
    <a class="dropdown-item" href="../articles/a3_task2.html">3. Task 2</a>
    <a class="dropdown-item" href="../articles/a4_task3.html">4. Task 3</a>
    <a class="dropdown-item" href="../articles/a5_supplementary_materials.html">5. biPOD Supplementary Materials and Methods</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>2. Task 1</h1>
            
      
      
      <div class="d-none name"><code>a2_task1.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://caravagnalab.github.io/biPOD/">biPOD</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: dplyr</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span></code></pre></div>
<p>The problem of characterizing a tumor growth model when growth rates
change at known time-points while considering both exponential and
logistic growths is denoted in <code>biPOD</code> as task 1. In this
vignette we are going to look at how to use <code>biPOD</code> for this
specific problem.</p>
<div class="section level2">
<h2 id="input-data">Input data<a class="anchor" aria-label="anchor" href="#input-data"></a>
</h2>
<p>We take the <code>xenografts</code> data and we make it ready for
inference by preparing the <code>count</code> column and by dividing the
<code>time</code> column by a factor of 7 (in order to work with a unit
of time of a week).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"xenografts"</span>, package <span class="op">=</span> <span class="st">"biPOD"</span><span class="op">)</span></span>
<span><span class="va">xenografts</span> <span class="op">&lt;-</span> <span class="va">xenografts</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>count <span class="op">=</span> <span class="va">tumour_volume</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>time <span class="op">=</span> <span class="va">time</span> <span class="op">/</span> <span class="fl">7</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="fit---variational-and-no-breakpoints">Fit - Variational and no breakpoints<a class="anchor" aria-label="anchor" href="#fit---variational-and-no-breakpoints"></a>
</h2>
<p>Let’s take a sample which does not undergo treatment and should
therefore exhibit a natural growth with a single parameter. Hence, we
are not going to consider any breakpoints for this sample.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mouse_id</span> <span class="op">&lt;-</span> <span class="fl">537</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="va">xenografts</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">mouse</span> <span class="op">==</span> <span class="va">mouse_id</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">biPOD</span><span class="fu">::</span><span class="fu"><a href="../reference/init.html">init</a></span><span class="op">(</span></span>
<span>  counts <span class="op">=</span> <span class="va">d</span>,</span>
<span>  sample <span class="op">=</span> <span class="va">mouse_id</span>,</span>
<span>  break_points <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">biPOD - bayesian inference for Population Dynamics</span> <span style="color: #00BBBB;">──────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Using sample named: <span style="color: #00BB00;">537</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> No group column present in input dataframe! A column will be added.</span></span></code></pre></div>
<p>Once the <code>bipod</code> object has been initialized it is
possible to visualize the data using the <code>plot_input</code>
function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">biPOD</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_input.html">plot_input</a></span><span class="op">(</span><span class="va">x</span>, log_scale <span class="op">=</span> <span class="cn">F</span>, add_highlights <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="a2_task1_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>Now, to fit the data for the first task one has to use the
<code>fit</code> function.</p>
<p>If you want to fit one specific type of growth
(<code>exponential</code> or <code>logistic</code>) you have to pass one
of the two to the parameter <code>growth_type</code>. Otherwise, if you
want to test both of them and choose the best one you have to set the
<code>growth_type</code> parameter to <code>both</code>.</p>
<p>Sometimes it might be helpful to scale the input data by a
<code>factor_size</code>, so that all the counts will be divided by
it.</p>
<p>When a population is decreasing or growing extremely slowly (<span class="math inline">\(\rho \sim 0\)</span>) the instant of time in which
the population was born might be impossible to infer. To deal with such
situations, or when <span class="math inline">\(t_0\)</span> is of no
interest, just set the <code>infer_t0</code> parameter to
<code>FALSE</code>.</p>
<p>In order to use a Variational Inference algorithm it suffice to set
the <code>variational</code> parameter to <code>TRUE</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">biPOD</span><span class="fu">::</span><span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  growth_type <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>  model_selection_algo <span class="op">=</span> <span class="st">"mixture_model"</span>,</span>
<span>  factor_size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  variational <span class="op">=</span> <span class="cn">T</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Fitting with model selection.</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> The first step of the inference will be performed using MCMC...</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plot---variational-and-no-breakpoints">Plot - Variational and no breakpoints<a class="anchor" aria-label="anchor" href="#plot---variational-and-no-breakpoints"></a>
</h2>
<div class="section level3">
<h3 id="diagnostics">Diagnostics<a class="anchor" aria-label="anchor" href="#diagnostics"></a>
</h3>
<p>The first plot to look at would be the one regarding the diagnostic
of the inference. In this case, having used VI, we are going to look at
the ELBO. To do so, let’s use the <code>plot_elbo</code> function which
requires a <code>bipod</code> object and the specification of which elbo
data we want to use since there might be multiple if we perform
different task on the same object.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">biPOD</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_elbo.html">plot_elbo</a></span><span class="op">(</span><span class="va">x</span>, elbo_data <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">fit_elbo</span>, diagnose <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="a2_task1_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="plot-of-fit">Plot of fit<a class="anchor" aria-label="anchor" href="#plot-of-fit"></a>
</h3>
<p>Use the function <code>plot_fit</code> to plot the fit resulting
after the inference of the first task.</p>
<p>Set <code>zoom</code> to <code>TRUE</code> to have a better view of
the observations and <code>full_process</code> to <code>TRUE</code> to
also plot the inferred value of <span class="math inline">\(t_0\)</span>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">biPOD</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_fit.html">plot_fit</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, zoom <span class="op">=</span> <span class="cn">T</span>, full_process <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="a2_task1_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="plot-posteriors">Plot posteriors<a class="anchor" aria-label="anchor" href="#plot-posteriors"></a>
</h3>
<p>You can use the general function <code>plot_posterior</code> to plot
the posterior for a given parameters (use <code>plot_posteriors</code>
for a set of parameters).</p>
<p>The names of the available parameters can be found in one of the fit
objects inside the <code>bipod</code> object. For example in this case
let’s plot <span class="math inline">\(t_0\)</span>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">variable</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "lp__"        "lp_approx__" "rho[1]"      "t0"          "K"</span></span>
<span><span class="fu">biPOD</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_posterior.html">plot_posterior</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  x_fit <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">fit</span>,</span>
<span>  par_name <span class="op">=</span> <span class="st">"t0"</span>,</span>
<span>  color <span class="op">=</span> <span class="st">"maroon"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="a2_task1_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="model-selection">Model selection<a class="anchor" aria-label="anchor" href="#model-selection"></a>
</h3>
<p>Since we selected between exponential and logistic there is also the
possibility to visualize this decision. In this case, having used the
<code>mixture_model</code> algorithm we can plot it using the ``</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">biPOD</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_mixture_model_omega.html">plot_mixture_model_omega</a></span><span class="op">(</span><span class="va">x</span>, plot_type <span class="op">=</span> <span class="st">"boxplot"</span>, color <span class="op">=</span> <span class="st">"forestgreen"</span><span class="op">)</span></span></code></pre></div>
<p><img src="a2_task1_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="fit---mcmc-and-with-breakpoints">Fit - MCMC and with breakpoints<a class="anchor" aria-label="anchor" href="#fit---mcmc-and-with-breakpoints"></a>
</h2>
<p>Let’s now consider a sample that undergoes treatment and should
therefore exhibit a multiple growth rates. For this tutorial we will
work with two manually chosen breakpoints (i.e 0 and 7).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mouse_id</span> <span class="op">&lt;-</span> <span class="fl">543</span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="va">xenografts</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">mouse</span> <span class="op">==</span> <span class="va">mouse_id</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">biPOD</span><span class="fu">::</span><span class="fu"><a href="../reference/init.html">init</a></span><span class="op">(</span></span>
<span>  counts <span class="op">=</span> <span class="va">d</span>,</span>
<span>  sample <span class="op">=</span> <span class="va">mouse_id</span>,</span>
<span>  break_points <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">7</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">biPOD - bayesian inference for Population Dynamics</span> <span style="color: #00BBBB;">──────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Using sample named: <span style="color: #00BB00;">543</span>.</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> No group column present in input dataframe! A column will be added.</span></span></code></pre></div>
<p>Now the input will be grouped in different time windows, as it can
also be seen by plotting it.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">biPOD</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_input.html">plot_input</a></span><span class="op">(</span><span class="va">x</span>, log_scale <span class="op">=</span> <span class="cn">T</span>, add_highlights <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<p><img src="a2_task1_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>Let’s use again the <code>fit</code> function.</p>
<p>We want to use the MCMC algorithm so make sure to set the
<code>variational</code> parameter to <code>FALSE</code>.</p>
<p>Moreover, we are going to use <code>bayes_factor</code> as a model
selection algorithm.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">biPOD</span><span class="fu">::</span><span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  growth_type <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>  model_selection_algo <span class="op">=</span> <span class="st">"bayes_factor"</span>,</span>
<span>  variational <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plot---mcmc-and-with-breakpoints">Plot - MCMC and with breakpoints<a class="anchor" aria-label="anchor" href="#plot---mcmc-and-with-breakpoints"></a>
</h2>
<div class="section level3">
<h3 id="diagnostics-1">Diagnostics<a class="anchor" aria-label="anchor" href="#diagnostics-1"></a>
</h3>
<p>Let’s plot the diagnostic of the inference. In this case, having used
MCMC, we are going to look at the chains to see if they’ve mixed
properly. To do so, let’s use the <code>plot_traces</code> function
which requires a <code>bipod</code> object and the specification of
which fit we want to use since there might be multiple if we perform
different task on the same object.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">biPOD</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_traces.html">plot_traces</a></span><span class="op">(</span><span class="va">x</span>, fit <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">fit</span>, pars <span class="op">=</span> <span class="cn">NULL</span>, diagnose <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The input vector 'pars' is empty. All the following parameters will be</span></span>
<span><span class="co">#&gt; reported: <span style="color: #0000BB;">"lp__"</span>, <span style="color: #0000BB;">"rho[1]"</span>, <span style="color: #0000BB;">"rho[2]"</span>, <span style="color: #0000BB;">"rho[3]"</span>, <span style="color: #0000BB;">"t0"</span>, and <span style="color: #0000BB;">"K"</span>.  It might take</span></span>
<span><span class="co">#&gt; some time...</span></span></code></pre></div>
<p><img src="a2_task1_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="plot-of-fit-1">Plot of fit<a class="anchor" aria-label="anchor" href="#plot-of-fit-1"></a>
</h3>
<p>Let’s use the function <code>plot_fit</code>. You can change the
legend using the parameter <code>legend_labels</code> and
<code>legend_title</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">biPOD</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_fit.html">plot_fit</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, legend_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Natural growth"</span>, <span class="st">"Treatment"</span>, <span class="st">"Relapse"</span><span class="op">)</span>, legend_title <span class="op">=</span> <span class="st">"Phase"</span><span class="op">)</span></span></code></pre></div>
<p><img src="a2_task1_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="plot-of-posteriors">Plot of posteriors<a class="anchor" aria-label="anchor" href="#plot-of-posteriors"></a>
</h3>
<p>Let’s use <code>plot_posteriors</code> function to plot all the
growth rates one against each other.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">biPOD</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_posteriors.html">plot_posteriors</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  x_fit <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">fit</span>,</span>
<span>  par_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rho[1]"</span>, <span class="st">"rho[2]"</span>, <span class="st">"rho[3]"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="a2_task1_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="model-selection-1">Model selection<a class="anchor" aria-label="anchor" href="#model-selection-1"></a>
</h3>
<p>And finally, let’s plot the Bayes factor using the
<code>plot_bayes_factor</code> function.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">biPOD</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_bayes_factor.html">plot_bayes_factor</a></span><span class="op">(</span><span class="va">x</span>, with_categories <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
<p><img src="a2_task1_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Giovanni Santacatterina.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
