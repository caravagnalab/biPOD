---
title: "1. Introdcution"
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(biPOD)
```

The `init` function of the library requires an input dataframe and a sample name.

# Input dataframe

The input dataframe requires the following columns:

- `time`  : the time points at which the population counts have been measured
- `count` : the population counts
- `group` : to divide the total time steps in different groups, for each group, different parameters will be obtained

If the input dataframe does not contain the `group` column, it will be assumed a single group, hence a single set of parameters will be found for all the points.

# Simulating dataframes

The package offers the possibility of simulating dataframes which arises from two different types of growth starting from a population of `n0` individuals.

1. Exponential growth, with two main parameters: birth rate `lambda` and death rate `mu`
2. Logistic growth, with three main parameters: birth rate `lambda`, death rate `mu`, and carrying capacity `K`

Additional parameters are the number of desired time points `steps` and the time intervals `delta_t`.
Both `lambda`, `mu` and `delta_t` can either be single values or vectors. Vectors can be used in order to simulate processes with varying growth rates or counts sampled using non-homogeneous time intervals.

An example for an exponential growth is the following:

```{r exponential dataframe}
biPOD::sim_stochastic_exponential(n0 = 10, lambda = 1, mu = c(.5, .75, 1), steps = 3, delta_t = c(1, 2, 3))
```

An example for a logistic growth is the following:

```{r logistic dataframe}
biPOD::sim_stochastic_logistic(n0 = 10, lambda = 1, mu = .5, K = 100, steps = 20, delta_t = 1)
```

# Init and plotting

Given an input dataframe and a sample name, it is possible to use the `init` function to create a `biPOD` object.

```{r init}
counts <- biPOD::sim_stochastic_exponential(n0 = 10, lambda = .5, mu = .3, steps = 50, delta_t = .1)
sample_name <- "Exponential sample"
bipod <- init(counts, sample = sample_name)
```

```{r evo plot}
biPOD::evolution_plot(bipod)
```

If different groups of parameters are needed, one should add a `group` column.
The group should be ordered in increasing order, and the first item of the `group` vector should be equal to the second one.

```{r}
counts <- biPOD::sim_stochastic_exponential(n0 = 10, lambda = .5, mu = c(.4, .45, .3), steps = 3, delta_t = .1)
groups <- c(0, 0, 1, 2)
counts$group <- groups
sample_name <- "Exponential sample"
bipod <- biPOD::init(counts, sample = sample_name)
```


