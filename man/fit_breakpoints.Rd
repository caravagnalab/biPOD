% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_breakpoints.R
\name{fit_breakpoints}
\alias{fit_breakpoints}
\title{Fit breakpoints and final growth model}
\usage{
fit_breakpoints(
  data,
  with_initiation,
  max_segments = 4,
  min_segment_size = 3,
  comparison = c("bic", "loo"),
  enforce_rho_separation = TRUE,
  alpha_rho = 0.05,
  models_to_fit = c("exponential"),
  noise_model = c("lognormal", "poisson"),
  chains = 4,
  iter = 4000,
  seed = 1234,
  cores = 4,
  t_prior_sd = 0.5
)
}
\arguments{
\item{data}{Data frame with columns \code{time} and \code{count}.}

\item{with_initiation}{Logical; fit model with initiation parameter.}

\item{max_segments}{Maximum number of segments to test.}

\item{min_segment_size}{Minimum size for each segment.}

\item{comparison}{Criterion for model selection: \code{"bic"} or \code{"loo"}.}

\item{enforce_rho_separation}{Logical; enforce separation of rho parameters.}

\item{alpha_rho}{Confidence level for rho separation.}

\item{models_to_fit}{Models to fit, default \code{"exponential"}.}

\item{chains}{Number of MCMC chains.}

\item{iter}{Total iterations.}

\item{seed}{Random seed.}

\item{cores}{Parallel chains.}

\item{t_prior_sd}{Standard deviation for breakpoint prior.}
}
\value{
A list with:
\item{evaluation_table}{Model evaluation results.}
\item{first_breakpoints}{Breakpoints from segmentation step.}
\item{final_breakpoints}{Breakpoints estimated in final fit.}
\item{final_fit}{Final fitted model object.}
\item{final_summary}{Summary of the final fit.}
}
\description{
This is the main exported function. It first proposes breakpoints via DE,
selects the best segmentation using model comparison, and finally refits
the model using the best breakpoints with full iterations.
}
